!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),n(t)}:n(window.jQuery)}(function(c){c.extend(c.FE.DEFAULTS,{saveInterval:1e4,saveURL:null,saveParams:{},saveParam:"body",saveMethod:"POST"}),c.FE.PLUGINS.save=function(a){function r(e,t){a.events.trigger("save.error",[{code:e,message:l[e]},t])}function t(t){if(void 0===t&&(t=a.html.get()),!1===a.events.trigger("save.before"))return!1;if(a.opts.saveURL){var e={};for(var n in a.opts.saveParams)if(a.opts.saveParams.hasOwnProperty(n)){var s=a.opts.saveParams[n];e[n]="function"==typeof s?s.call(this):s}var o={};o[a.opts.saveParam]=t,c.ajax({type:a.opts.saveMethod,url:a.opts.saveURL,data:c.extend(o,e),crossDomain:a.opts.requestWithCORS,xhrFields:{withCredentials:a.opts.requestWithCredentials},headers:a.opts.requestHeaders}).done(function(e){u=t,a.events.trigger("save.after",[e])}).fail(function(e){r(d,e.response||e.responseText)})}else r(f)}function e(){clearTimeout(i),i=setTimeout(function(){var e=a.html.get();(u!=e||v)&&(v=!1,t(u=e))},a.opts.saveInterval)}function n(){e(),v=!1}function s(){v=!0}function o(){a.opts.saveInterval&&(u=a.html.get(),a.events.on("contentChanged",e),a.events.on("keydown destroy",function(){clearTimeout(i)}))}var i=null,u=null,v=!1,f=1,d=2,l={};return l[f]="Missing saveURL option.",l[d]="Something went wrong during save.",{_init:o,save:t,reset:n,force:s}},c.FE.DefineIcon("save",{NAME:"floppy-o"}),c.FE.RegisterCommand("save",{title:"Save",undo:!1,focus:!1,refreshAfterCallback:!1,callback:function(){this.save.save()},plugin:"save"})});