!function(i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),i(t)}:i(window.jQuery)}(function(M){M.extend(M.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style"],wordPasteModal:!0}),M.FE.PLUGINS.wordPaste=function(A){function e(){A.events.on("paste.wordPaste",function(e){return s=e,A.opts.wordPasteModal?t():r(!0),!1})}function n(){var e='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return e+='<p style="text-align: left;">'+A.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",(e+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+A.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+A.language.translate("Keep")+"</button></div>")+"</div>"}function t(){if(!a){var e='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+A.language.translate("Word Paste Detected")+"</h4>",t=n(),i=A.modals.create(S,e,t),r=i.$body;a=i.$modal,i.$modal.addClass("fr-middle"),A.events.bindClick(r,"button.fr-remove-word",function(){(a.data("instance")||A).wordPaste.clean()}),A.events.bindClick(r,"button.fr-keep-word",function(){(a.data("instance")||A).wordPaste.clean(!0)}),A.events.$on(M(A.o_win),"resize",function(){A.modals.resize(S)})}A.modals.show(S),A.modals.resize(S)}function i(){A.modals.hide(S)}function r(e){var t=A.opts.wordAllowedStyleProps;e||(A.opts.wordAllowedStyleProps=[]),0===(s=s.replace(/^\n*/g,"").replace(/^ /g,"")).indexOf("<colgroup>")&&(s="<table>"+s+"</table>"),s=l(s,A.paste.getRtfClipboard()),s=A.paste.removeEmptyTags(s),i(),A.paste.clean(s,!0,!0),A.opts.wordAllowedStyleProps=t}function C(e){e.parentNode&&e.parentNode.removeChild(e)}function o(e,t){if(t(e))for(var i=e.firstChild;i;){var r=i,n=i.previousSibling;i=i.nextSibling,o(r,t),r.previousSibling||r.nextSibling||r.parentNode||!i||n==i.previousSibling||!i.parentNode?r.previousSibling||r.nextSibling||r.parentNode||!i||i.previousSibling||i.nextSibling||i.parentNode||(n?i=n.nextSibling?n.nextSibling.nextSibling:null:e.firstChild&&(i=e.firstChild.nextSibling)):i=n?n.nextSibling:e.firstChild}}function y(e){if(!e.getAttribute("style")||!/mso-list:[\s]*l/gi.test(e.getAttribute("style").replace(/\n/gi,"")))return!1;try{if(!e.querySelector('[style="mso-list:Ignore"]'))return!1}catch(A){return!1}return!0}function p(e){return e.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function c(e,t){var i=e.cloneNode(!0);if(i.firstElementChild&&"A"==i.firstElementChild.tagName&&(i=i.firstElementChild),-1!=["H1","H2","H3","H4","H5","H6"].indexOf(e.tagName)){var r=document.createElement(e.tagName.toLowerCase());r.setAttribute("style",e.getAttribute("style")),r.innerHTML=i.innerHTML,i.innerHTML=r.outerHTML}o(i,function(e){return e.nodeType==Node.ELEMENT_NODE&&("mso-list:Ignore"==e.getAttribute("style")&&e.parentNode.removeChild(e),u(e,t)),!0});var n=i.innerHTML;return n.replace(/<!--[\s\S]*?-->/gi,"")}function m(e,t){var i=/[0-9a-zA-Z]./gi,r=!1;e.firstElementChild&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.firstChild&&!(r=r||i.test(e.firstElementChild.firstElementChild.firstChild.data||""))&&e.firstElementChild.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.firstElementChild.firstChild&&(r=r||i.test(e.firstElementChild.firstElementChild.firstElementChild.firstChild.data||""));var n=r?"ol":"ul",l=p(e),a="<"+n+"><li>"+c(e,t),s=e.nextElementSibling,o=e.parentNode;for(C(e),e=null;s&&y(s);){var d=s.previousElementSibling,f=p(s);if(l<f)a+=m(s,t).outerHTML;else{if(f<l)break;a+="</li><li>"+c(s,t)}if(l=f,s.previousElementSibling||s.nextElementSibling||s.parentNode){var g=s;s=s.nextElementSibling,C(g),g=null}else s=d?d.nextElementSibling:o.firstElementChild}a+="</li></"+n+">";var u=document.createElement("div");return u.innerHTML=a,u.firstElementChild}function h(e,t){for(var i=document.createElement(t),r=0;r<e.attributes.length;r++){var n=e.attributes[r].name;i.setAttribute(n,e.getAttribute(n))}return i.innerHTML=e.innerHTML,e.parentNode.replaceChild(i,e),i}function v(e,t){A.node.clearAttributes(e);for(var i=e.firstElementChild,r=0,n=!1,l=null;i;){i.firstElementChild&&-1!=i.firstElementChild.tagName.indexOf("W:")&&(i.innerHTML=i.firstElementChild.innerHTML),(l=i.getAttribute("width"))||n||(n=!0),r+=parseInt(l,10),(!i.firstChild||i.firstChild&&i.firstChild.data==M.FE.UNICODE_NBSP)&&(i.firstChild&&C(i.firstChild),i.innerHTML="<br>");for(var a=i.firstElementChild,s=1==i.children.length;a;)"P"!=a.tagName||y(a)||s&&N(a),a=a.nextElementSibling;if(t){var o=i.getAttribute("class");if(o){var d=(o=w(o)).match(/xl[0-9]+/gi);if(d){var f="."+d[0];t[f]&&T(i,t[f])}}t.td&&T(i,t.td)}var g=i.getAttribute("style");g&&(g=w(g))&&";"!=g.slice(-1)&&(g+=";");var u=i.getAttribute("valign");if(!u&&g){var p=g.match(/vertical-align:.+?[; "]{1,1}/gi);p&&(u=p[p.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var c=null;if(g){var m=g.match(/text-align:.+?[; "]{1,1}/gi);m&&(c=m[m.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==c&&(c=null)}var h=null;if(g){var v=g.match(/background:.+?[; "]{1,1}/gi);v&&(h=v[v.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var b=i.getAttribute("colspan"),E=i.getAttribute("rowspan");b&&i.setAttribute("colspan",b),E&&i.setAttribute("rowspan",E),u&&(i.style["vertical-align"]=u),c&&(i.style["text-align"]=c),h&&(i.style["background-color"]=h),l&&i.setAttribute("width",l),i=i.nextElementSibling}for(i=e.firstElementChild;i;)l=i.getAttribute("width"),n?i.removeAttribute("width"):i.setAttribute("width",100*parseInt(l,10)/r+"%"),i=i.nextElementSibling}function N(e){var t=e.parentNode,i=e.getAttribute("align");i&&(t&&"TD"==t.tagName?t.setAttribute("style",t.getAttribute("style")+"text-align:"+i+";"):e.style["text-align"]=i,e.removeAttribute("align"))}function w(e){return e.replace(/\n|\r|\n\r|&quot;/g,"")}function T(e,t,i){if(t){var r=e.getAttribute("style");r&&";"!=r.slice(-1)&&(r+=";"),t&&";"!=t.slice(-1)&&(t+=";"),t=t.replace(/\n/gi,"");var n=null;n=i?(r||"")+t:t+(r||""),e.setAttribute("style",n)}}function d(e){var t=e.getAttribute("style");if(t){(t=w(t))&&";"!=t.slice(-1)&&(t+=";");var i=t.match(/(^|\S+?):.+?;{1,1}/gi);if(i){for(var r={},n=0;n<i.length;n++){var l=i[n].split(":");2==l.length&&("text-align"==l[0]&&"SPAN"==e.tagName||(r[l[0]]=l[1]))}var a="";for(var s in r)if(r.hasOwnProperty(s)){if("font-size"==s&&"pt;"==r[s].slice(-3)){var o=null;try{o=parseFloat(r[s].slice(0,-3),10)}catch(p){}o&&(o=Math.round(1.33*o),r[s]=o+"px;")}a+=s+":"+r[s]}a&&e.setAttribute("style",a)}}}function g(e){for(var t=e.match(/[0-9a-f]{2}/gi),i=[],r=0;r<t.length;r++)i.push(String.fromCharCode(parseInt(t[r],16)));var n=i.join("");return btoa(n)}function f(e,t){if(t){var i;if("IMG"==e.tagName){var r=e.getAttribute("src");if(!r||-1==r.indexOf("file://"))return;i=x[e.getAttribute("v:shapes")]}else i=e.parentNode.getAttribute("o:spid");if(i){var n="hplid"+i.substring(8),l=t.split(n);if(!l||2==l.length){var a=l[1].split("bliptag");if(!(a&&a.length<2)){var s=null;if(-1!=a[0].indexOf("pngblip")?s="image/png":-1!=a[0].indexOf("jpegblip")&&(s="image/jpeg"),s){var o=a[1].split("}");if(!(o&&o.length<2)){var d;if(2<o.length&&-1!=o[0].indexOf("blipuid"))d=o[1].split(" ");else{if((d=o[0].split(" "))&&d.length<2)return;d.shift()}var f="data:"+s+";base64,"+g(d.join(""));"IMG"===e.tagName?(e.src=f,e.setAttribute("data-fr-image-pasted",!0)):M(e.parentNode).before('<img data-fr-image-pasted="true" src="'+f+'" style="'+e.parentNode.getAttribute("style")+'">').remove()}}}}}}}function u(e,t){var i=e.tagName,r=i.toLowerCase();if(e.firstElementChild&&("I"==e.firstElementChild.tagName?h(e.firstElementChild,"em"):"B"==e.firstElementChild.tagName&&h(e.firstElementChild,"strong")),-1!=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(i))return C(e),!1;"O:P"==i&&"&nbsp;"==e.innerHTML&&(e.innerHTML=M.FE.INVISIBLE_SPACE);var n=-1,l=["META","LINK","XML","ST1:","O:","W:","FONT"];for(n=0;n<l.length;n++)if(-1!=i.indexOf(l[n]))return e.innerHTML&&(e.outerHTML=e.innerHTML),C(e),!1;if("TD"!=i){var a=e.getAttribute("class");if(t&&a){var s=(a=w(a)).split(" ");for(n=0;n<s.length;n++){var o=[],d="."+s[n];o.push(d),d=r+d,o.push(d);for(var f=0;f<o.length;f++)t[o[f]]&&T(e,t[o[f]])}e.removeAttribute("class")}t&&t[r]&&T(e,t[r])}if(-1!=["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(i)){var g=e.getAttribute("class");if(g&&(t&&t[i.toLowerCase()+"."+g]&&T(e,t[i.toLowerCase()+"."+g]),-1!=g.toLowerCase().indexOf("mso"))){var u=w(g);(u=u.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""))?e.setAttribute("class",u):e.removeAttribute("class")}var p=e.getAttribute("style");if(p){var c=p.match(/text-align:.+?[; "]{1,1}/gi);c&&c[c.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1")}N(e)}if("TR"==i&&v(e,t),"A"==i&&!e.attributes.getNamedItem("href")&&e.innerHTML&&(e.outerHTML=e.innerHTML),"TD"!=i&&"TH"!=i||e.innerHTML||(e.innerHTML="<br>"),"TABLE"==i&&(e.style.width="100%"),e.getAttribute("lang")&&e.removeAttribute("lang"),e.getAttribute("style")&&-1!=e.getAttribute("style").toLowerCase().indexOf("mso")){var m=w(e.getAttribute("style"));(m=m.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""))?e.setAttribute("style",m):e.removeAttribute("style")}return!0}function b(e){var t={},i=e.getElementsByTagName("style");if(i.length){var r=i[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(r)for(var n=0;n<r.length;n++){var l=r[n],a=l.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),s=l.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");a=a.replace(/^[\s]|[\s]$/gm,""),s=s.replace(/^[\s]|[\s]$/gm,""),a=a.replace(/\n|\r|\n\r/g,""),s=s.replace(/\n|\r|\n\r/g,"");for(var o=a.split(", "),d=0;d<o.length;d++)t[o[d]]=s}}return t}function E(e){for(var t=e.split("v:shape"),i=1;i<t.length;i++){var r=t[i],n=r.split(' id="')[1];if(n&&1<n.length){n=n.split('"')[0];var l=r.split(' o:spid="')[1];l&&1<l.length&&(l=l.split('"')[0],x[n]=l)}}}function l(e,t){E(e=e.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/gi,"$1"));var i=(new DOMParser).parseFromString(e,"text/html"),r=i.head,n=i.body,l=b(r);o(n,function(e){if(e.nodeType==Node.TEXT_NODE&&/\n|\u00a0/.test(e.data)){if(!/\S/.test(e.data))return e.data==M.FE.UNICODE_NBSP?(e.data="\u200b",!0):(C(e),!1);e.data=e.data.replace(/\n/gi," ")}return!0}),o(n,function(e){return e.nodeType!=Node.ELEMENT_NODE||"V:IMAGEDATA"!=e.tagName&&"IMG"!=e.tagName||f(e,t),!0}),o(n,function(e){if(e.nodeType==Node.TEXT_NODE)return e.data=e.data.replace(/<br>(\n|\r)/gi,"<br>"),!1;if(e.nodeType!=Node.ELEMENT_NODE)return e.nodeType!=Node.COMMENT_NODE||(C(e),!1);if(y(e)){var t=e.parentNode,i=e.previousSibling,r=m(e,l),n=null;return(n=i?i.nextSibling:t.firstChild)?t.insertBefore(r,n):t.appendChild(r),!1}return u(e,l)}),o(n,function(e){if(e.nodeType==Node.ELEMENT_NODE){var t=e.tagName;if(!e.innerHTML&&-1==["BR","IMG"].indexOf(t)){for(var i=e.parentNode;i&&(C(e),!(e=i).innerHTML);)i=e.parentNode;return!1}d(e)}return!0});var a=n.outerHTML,s=A.opts.htmlAllowedStyleProps;return A.opts.htmlAllowedStyleProps=A.opts.wordAllowedStyleProps,a=A.clean.html(a,A.opts.wordDeniedTags,A.opts.wordDeniedAttrs,!1),A.opts.htmlAllowedStyleProps=s,a}var a,s,S="word_paste",x={};return{_init:e,clean:r}}});