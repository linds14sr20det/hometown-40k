!function(i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),i(t)}:i(window.jQuery)}(function(u){u.extend(u.FE.DEFAULTS,{quickInsertButtons:["image","table","ul","ol","hr"],quickInsertTags:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote"]}),u.FE.QUICK_INSERT_BUTTONS={image:{icon:"insertImage",callback:function(){var e=this;e.shared.$qi_image_input||(e.shared.$qi_image_input=u('<input accept="image/*" name="quickInsertImage'+this.id+'" style="display: none;" type="file">'),u("body:first").append(e.shared.$qi_image_input),e.events.$on(e.shared.$qi_image_input,"change",function(){var e=u(this).data("inst");this.files&&(e.quickInsert.hide(),e.image.upload(this.files)),u(this).val("")},!0)),e.$qi_image_input=e.shared.$qi_image_input,e.helpers.isMobile()&&e.selection.save(),e.$qi_image_input.data("inst",e).trigger("click")},requiredPlugin:"image",title:"Insert Image"},table:{icon:"insertTable",callback:function(){this.quickInsert.hide(),this.table.insert(2,2),this.undo.saveStep()},requiredPlugin:"table",title:"Insert Table"},ol:{icon:"formatOL",callback:function(){this.quickInsert.hide(),this.lists.format("OL"),this.undo.saveStep()},requiredPlugin:"lists",title:"Ordered List"},ul:{icon:"formatUL",callback:function(){this.quickInsert.hide(),this.lists.format("UL"),this.undo.saveStep()},requiredPlugin:"lists",title:"Unordered List"},hr:{icon:"insertHR",callback:function(){this.quickInsert.hide(),this.commands.insertHR(),this.undo.saveStep()},title:"Insert Horizontal Line"}},u.FE.DefineIcon("quickInsert",{PATH:'<path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/>',template:"svg"}),u.FE.RegisterQuickInsertCommand=function(e,t){u.FE.QUICK_INSERT_BUTTONS[e]=t},u.FE.PLUGINS.quickInsert=function(o){function t(e){var t,i,s;t=e.offset().top-o.$box.offset().top,i=0-d.outerWidth(),s=(d.outerHeight()-e.outerHeight())/2,o.opts.iframe&&(t+=o.$iframe.offset().top-o.helpers.scrollTop()),d.hasClass("fr-on")&&0<=t&&c.css("top",t-s),0<=t&&t-s<=o.$box.outerHeight()-e.outerHeight()?(d.hasClass("fr-hidden")&&(d.hasClass("fr-on")&&n(),d.removeClass("fr-hidden")),d.css("top",t-s)):d.hasClass("fr-visible")&&(d.addClass("fr-hidden"),r()),d.css("left",i)}function i(e){d||a(),d.hasClass("fr-on")&&r(),o.$box.append(d),t(e),d.data("tag",e),d.addClass("fr-visible")}function e(){if(o.core.hasFocus()){var e=o.selection.element();o.node.isBlock(e)||(e=o.node.blockParent(e)),e&&o.node.isEmpty(e)&&o.node.isElement(e.parentNode)&&0<=o.opts.quickInsertTags.indexOf(e.tagName.toLowerCase())?d&&d.data("tag").is(u(e))&&d.hasClass("fr-on")?r():o.selection.isCollapsed()&&i(u(e)):s()}}function s(){d&&(o.html.checkIfEmpty(),d.hasClass("fr-on")&&r(),d.removeClass("fr-visible fr-on"),d.css("left",-9999).css("top",-9999))}function n(e){if(e&&e.preventDefault(),d.hasClass("fr-on")&&!d.hasClass("fr-hidden"))r();else{if(!o.shared.$qi_helper){for(var t=o.opts.quickInsertButtons,i='<div class="fr-qi-helper">',s=0,n=0;n<t.length;n++){var a=u.FE.QUICK_INSERT_BUTTONS[t[n]];a&&(!a.requiredPlugin||u.FE.PLUGINS[a.requiredPlugin]&&0<=o.opts.pluginsEnabled.indexOf(a.requiredPlugin))&&(i+='<a class="fr-btn fr-floating-btn" role="button" title="'+o.language.translate(a.title)+'" tabIndex="-1" data-cmd="'+t[n]+'" style="transition-delay: '+.025*s+++'s;">'+o.icon.create(a.icon)+"</a>")}i+="</div>",o.shared.$qi_helper=u(i),o.tooltip.bind(o.shared.$qi_helper,"> a.fr-btn")}(c=o.shared.$qi_helper).appendTo(o.$box),setTimeout(function(){c.css("top",parseFloat(d.css("top"))),c.css("left",parseFloat(d.css("left"))+d.outerWidth()),c.find("a").addClass("fr-size-1"),d.addClass("fr-on")},10)}}function r(){var e=o.$box.find(".fr-qi-helper");e.length&&(e.find("a").removeClass("fr-size-1"),e.css("left",-9999),d.hasClass("fr-hidden")||d.removeClass("fr-on"))}function a(){o.shared.$quick_insert||(o.shared.$quick_insert=u('<div class="fr-quick-insert"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+o.language.translate("Quick Insert")+'">'+o.icon.create("quickInsert")+"</a></div>")),d=o.shared.$quick_insert,o.tooltip.bind(o.$box,".fr-quick-insert > a.fr-floating-btn"),o.events.on("destroy",function(){d.removeClass("fr-on").appendTo(u("body:first")).css("left",-9999).css("top",-9999),c&&(r(),c.appendTo(u("body:first")))},!0),o.events.on("shared.destroy",function(){d.html("").removeData().remove(),d=null,c&&(c.html("").removeData().remove(),c=null)},!0),o.events.on("commands.before",s),o.events.on("commands.after",function(){o.popups.areVisible()||e()}),o.events.bindClick(o.$box,".fr-quick-insert > a",n),o.events.bindClick(o.$box,".fr-qi-helper > a.fr-btn",function(e){var t=u(e.currentTarget).data("cmd");u.FE.QUICK_INSERT_BUTTONS[t].callback.apply(o,[e.currentTarget])}),o.events.$on(o.$wp,"scroll",function(){d.hasClass("fr-visible")&&t(d.data("tag"))})}function l(){if(!o.$wp)return!1;o.opts.iframe&&o.$el.parent("html").find("head").append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">'),o.popups.onShow("image.edit",s),o.events.on("mouseup",e),o.helpers.isMobile()&&o.events.$on(u(o.o_doc),"selectionchange",e),o.events.on("blur",s),o.events.on("keyup",e),o.events.on("keydown",function(){setTimeout(function(){e()},0)})}var d,c;return{_init:l,hide:s}}});